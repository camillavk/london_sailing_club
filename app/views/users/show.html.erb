</br>
<div class="panel panel-info">
  <div class="panel-heading"><h2>Details</h2></div>
  <div class="panel-body">
    <dl>
      <dt>Email:</dt>
      <dd><%= @user.email %></dd>
      <dt>Name:</dt>
      <dd><%= @user.name %></dd>
      <dt>SMS Alerts:</dt>
      <dd>
        <%= form_for(@user, :remote => true) do |f| %>
          <%= f.telephone_field :number, placeholder: "Enter mobile number", class: "form-control", :onchange => 'this.form.submit()' %>
        <% end %>
      </dd>
      <dd>
        <%= form_for(@user, :remote => true) do |f| %>
          <%= f.check_box :sms_alerts, :onchange => 'this.form.submit()' %>
          <%= f.label "Yes, I want to receive SMS alerts of upcoming trips" %>
        <% end %>
      </dd>
    </dl>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading"><h2>Payments</h2></div>
  <% if @payments.nil? %>
    <div class="panel-body">
      <p>You haven't made any payments yet</p>
      <%= link_to "Click here to choose a plan", root_url %>
    </div>
  <% else %>
    <table class="table table-hover">
      <tr>
        <th>Amount</th>
        <th>Status</th>
        <th>Charge date</th>
        <th></th>
      </tr>
      <% @payments.each do |payment| %>
        <tr>
          <td><%= Money.new(payment[0].amount, payment[0].currency).format %></td>
          <td><%= payment[0].status %></td>
          <td><%= payment[1] == "gocardless" ? payment[0].charge_date : Time.at(payment[0].created).to_datetime %></td>
          <td>
            <% if payment[0].status == 'pending_submission' %>
              <%= link_to 'Cancel payment', { controller: 'gocardless', action: 'cancel', payment_id: "#{payment.id}" }, data: {confirm: 'Are you sure you want to cancel your payment?'} %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </table>
  <% end %>
</div>
